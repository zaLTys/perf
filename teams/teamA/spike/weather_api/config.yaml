test_name: "teamA_spike_weather_api"

# Open-Meteo API - Free weather API (no authentication required)
base_url: "https://api.open-meteo.com"

# Environment overrides (optional - same API for all environments in this case)
environments:
  dev:
    base_url: "https://api.open-meteo.com"
  staging:
    base_url: "https://api.open-meteo.com"
  prod:
    base_url: "https://api.open-meteo.com"

endpoints:
  # Weather forecast endpoint
  forecast: "/v1/forecast"
  
  # Geocoding endpoint (to search for cities)
  geocoding: "/v1/search"

scenarios:
  # Spike test - sudden and dramatic increase in load
  weather_spike:
    executor: "ramping-arrival-rate"
    startRate: 1
    timeUnit: "1s"
    preAllocatedVUs: 50
    maxVUs: 200
    stages:
      # Rapid spike: 0 to 100 requests/second in 10s
      - duration: "10s"
        target: 100
      # Sustain peak load for 30 seconds
      - duration: "30s"
        target: 100
      # Sudden drop back to baseline
      - duration: "10s"
        target: 5
      # Recovery period at low load
      - duration: "20s"
        target: 5

thresholds:
  # More lenient thresholds for spike testing (expecting some degradation)
  http_req_duration:
    - "p(90)<2000"
    - "p(95)<3000"
    - "p(99)<5000"
  
  # Lower success rate threshold (spike tests often reveal breaking points)
  success_rate:
    - "rate>0.95"
  
  # HTTP request failure rate should stay below 10%
  http_req_failed:
    - "rate<0.10"
